## Введение
Цель работы:
Целью данного проекта является разработка и обучение нейронной сети YOLO (You Only Look Once) для решения задачи обнаружения и классификации объектов на изображениях. В качестве объектов могут выступать различные классы, например, породы кошек и собак.

Актуальность:
Современные системы компьютерного зрения широко применяются в различных областях: от систем видеонаблюдения и распознавания лиц до автономного транспорта и медицинской диагностики. YOLO является одной из наиболее популярных архитектур для задач детекции объектов, так как обеспечивает высокую точность при реальном времени работы.

Задачи работы:

1. Подготовить и разметить собственный датасет или использовать готовый.

2. Настроить и обучить модель YOLO на выбранных классах объектов.

3. Проанализировать процесс обучения с использованием графиков и метрик качества.

4. Разработать GUI-приложение для тестирования обученной модели на изображениях и видеопотоке.

Методы и инструменты:

1. Модель: YOLOv8 (Ultralytics).

2. Среда разработки: Python 3.10, библиотеки OpenCV, PIL, Tkinter.

3. Датасет: собственная разметка или открытые датасеты.

4. Метрики качества: mAP50, mAP50-95, Precision, Recall, F1-Score.

## Описание задачи и постановка эксперимента
Описание задачи и постановка эксперимента

Характеристика датасета:

1. Количество изображений: 640.

2. Количество классов: 6 (abyssinian, bengal, birman, bombay, british_shorthair, egyptian_mau).

3. Источник изображений: скачанный датасет с открытого источника.

Разделение данных:

1. Обучающая выборка (train) — 80% изображений.

2. Валидационная выборка (val) — 20% изображений.

Выбор классов объектов:

1. Классы были выбраны исходя из целей эксперимента: распознавание пород кошек.

2. Каждый класс должен иметь минимум 15–30 изображений, чтобы модель могла обучаться корректно.

3. На этапе обучения соблюдалось равномерное распределение изображений по классам.

Разметка изображений:

1. Использовался инструмент LabelImg для создания bounding box (рамок) вокруг объектов.

2. Формат разметки: YOLO (.txt)


Координаты нормализованы относительно размеров изображения (0–1).

Для проверки качества разметки использовались случайные изображения из обучающей и валидационной выборки.

Разметка могла выполняться вручную или с использованием полуавтоматических инструментов, если была доступна предварительная модель.

Постановка эксперимента:
Подготовленный датасет разбивается на обучающую и валидационную выборки. Настраиваются гиперпараметры модели: learning rate, batch size, количество эпох. Обучение YOLO проводится до достижения стабильной точности на валидационной выборке. После обучения производится оценка качества модели по метрикам mAP, Precision, Recall и F1-Score.

## 3. Процесс обучения нейронной сети YOLO

Для решения задачи обнаружения и классификации пород кошек была использована современная нейронная сеть YOLOv8, предназначенная для задач объектного обнаружения в реальном времени. В качестве базовой архитектуры была выбрана конфигурация YOLOv8n (nano), которая отличается малым количеством параметров и высокой скоростью работы, что особенно важно при обучении на центральном процессоре и ограниченных вычислительных ресурсах.

Модель инициализировалась предобученными весами, полученными на наборе данных COCO, что позволило использовать перенос обучения и повысить качество распознавания при ограниченном объёме обучающих данных.

3.1 Выбор конфигурации модели

Для обучения была выбрана модель YOLOv8n, содержащая около 3 миллионов параметров. Данная конфигурация обеспечивает оптимальный баланс между точностью и вычислительной сложностью, что делает её подходящей для учебных и исследовательских задач.

Размер входных изображений был установлен равным 400×400 пикселей, что позволило существенно сократить время обучения и потребление оперативной памяти без значительной потери точности обнаружения объектов.

### Настройка гиперпараметров обучения
| Параметр      | Значение | Описание                     |
| ------------- | -------- | ---------------------------- |
| Epochs        | 10       | Количество эпох обучения     |
| Batch size    | 1        | Размер батча                 |
| Learning rate | 0.001    | Начальная скорость обучения  |
| Optimizer     | Adam     | Алгоритм оптимизации         |
| Image size    | 416×416  | Размер входного изображения  |
| Device        | CPU      | Устройство обучения          |
| Classes       | 6        | Количество обучаемых классов |

В качестве оптимизатора был выбран алгоритм Adam, обеспечивающий быструю и стабильную сходимость за счёт адаптивной настройки скорости обучения для каждого параметра модели. Начальное значение скорости обучения было установлено равным 0.001, что является стандартным и рекомендуемым значением для обучения моделей семейства YOLO.

Размер батча был установлен равным 1, что обусловлено ограничениями доступной оперативной памяти при обучении на центральном процессоре. Несмотря на малый размер батча, модель продемонстрировала устойчивую динамику обучения и стабильное снижение функций потерь.

Обучение проводилось в течение 10 эпох, что оказалось достаточным для достижения сходимости модели и получения высоких значений метрик качества.

### Анализ процесса обучения

В процессе обучения отслеживались значения следующих функций потерь:

1. Box loss — ошибка локализации ограничивающих рамок;

2. Classification loss — ошибка классификации объектов;

3. Distribution Focal Loss (DFL) — ошибка аппроксимации формы ограничивающих рамок.

В ходе обучения наблюдалось устойчивое уменьшение значений всех функций потерь. Значение box loss уменьшилось с 0.99 на первой эпохе до 0.59 на последней, а classification loss снизилось с 3.32 до 1.25, что свидетельствует о корректной сходимости модели и улучшении качества как локализации, так и классификации объектов.

### Валидация модели

После каждой эпохи проводилась валидация модели на отложенной выборке. В процессе валидации оценивались метрики Precision, Recall, mAP@50 и mAP@50–95. К концу обучения модель достигла значения mAP@50 = 0.825 и mAP@50–95 = 0.714, что является хорошим результатом для задачи обнаружения и классификации объектов при использовании облегчённой конфигурации модели и ограниченного числа эпох.

### Динамика потерь (loss)

Тренировочные потери:

1. train/box_loss (локализация объектов) постепенно уменьшается с 0.986 → 0.594, что говорит о том, что модель лучше предсказывает положение объектов по мере обучения.

2. train/cls_loss (классификация) снижается с 3.319 → 1.246, что демонстрирует улучшение точности классификации объектов.

3. train/dfl_loss (регрессия границ) колеблется, но в целом снижается с 1.174 → 0.894, показывая улучшение предсказания размеров объектов.

Валидационные потери: val/box_loss, val/cls_loss, val/dfl_loss также снижаются, что указывает на отсутствие сильного переобучения и стабильность обучения.

Вывод: модель постепенно учится лучше локализовывать и классифицировать объекты, потери снижаются как на тренировочной, так и на валидационной выборке.

### Метрики качества

1. Precision, начало обучения: 0.475, низкая точность предсказаний.
После 10 эпох: 0.675, рост точности свидетельствует о том, что меньше ложных срабатываний.
Общий тренд: стабильный рост с небольшими колебаниями.

2. Recall начало обучения: 0.045, модель почти не захватывала объекты.
После 10 эпох: 0.849, резкий рост полноты указывает на успешное нахождение большинства объектов.

В целом, recall растёт быстрее precision, что может говорить о том, что модель учится находить объекты даже в ущерб небольшому количеству ложных срабатываний на ранних эпохах.

3. mAP50 (точность по IoU 0.5) С 0.157 → 0.825, демонстрирует резкое улучшение общей детекционной способности модели.
mAP50-95 с 0.115 → 0.713 — более строгая метрика, также показывает устойчивый рост.

Вывод: метрики качества показывают уверенное улучшение модели, с mAP > 0.8 на 10-й эпохе, что говорит о высоком качестве детекции.

### Тестирование и демонстрация работы ПО

<img width="1115" height="911" alt="image" src="https://github.com/user-attachments/assets/ad2fa1d4-c0ab-441a-89fd-91cc89d4e52a" />

<img width="1126" height="917" alt="image" src="https://github.com/user-attachments/assets/c923b8fa-d215-48a5-9ff6-59661e89f8bf" />

<img width="1123" height="915" alt="image" src="https://github.com/user-attachments/assets/2b543f05-b95b-4b12-9cc4-accc55216f6c" />

## ЗАКЛЮЧЕНИЕ

В рамках данной работы была проведена комплексная исследовательская и практическая работа по изучению устройства и процесса обучения нейронной сети YOLO (You Only Look Once), предназначенной для обнаружения и классификации объектов на изображениях.

В ходе работы были решены следующие задачи:

1. Выбран и подготовлен датасет с 2–8 классами объектов, включая ручную и/или полуавтоматическую разметку изображений для корректного обучения модели.

2. Проведен процесс обучения нейронной сети YOLO с настройкой ключевых гиперпараметров, таких как learning rate, batch size, optimizer и количество эпох. Обучение сопровождалось мониторингом потерь (box_loss, cls_loss, dfl_loss) и метрик качества (Precision, Recall, mAP50, mAP50-95).

3. Проанализированы полученные графики динамики обучения. Наблюдалось устойчивое снижение потерь как на тренировочной, так и на валидационной выборке, а метрики качества (precision, recall, mAP) демонстрировали значительное улучшение, что свидетельствует о корректном обучении модели. На последних эпохах модель достигла mAP50 > 0.8 и высокой полноты распознавания объектов, что подтверждает эффективность обучения.

4. Разработано программное приложение с GUI, позволяющее проверять работу обученной модели на произвольных изображениях и видеопотоке. Тестирование показало корректное обнаружение и классификацию объектов в реальном времени, с высокой точностью и полнотой распознавания.

Таким образом, поставленные цели работы были достигнуты: была изучена архитектура YOLO, реализован процесс обучения на собственном датасете, проведена интерпретация результатов обучения и создано программное средство для практического применения обученной нейронной сети. Работа демонстрирует возможности YOLO для задач детекции объектов и может быть использована в реальных приложениях компьютерного зрения, таких как видеонаблюдение, анализ изображений и автоматизированное управление объектами.



